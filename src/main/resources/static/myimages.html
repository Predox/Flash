<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minhas Images</title>
    <link rel="stylesheet" href="css/style.css">
    <script>
        window.addEventListener("DOMContentLoaded", () => {
            fetch("https://flash.up.railway.app/imagens/listar", {
                method: "GET",
                credentials: "include"
            })
                .then(res => res.json())
                .then(ids => {
                    const container = document.getElementById("perfil-images-container");
                    const labelFotos = document.getElementById("n-photos-perfil");

                    labelFotos.innerHTML = `<strong>Fotos editadas:</strong> <span class="small-text">${ids.length}</span>`;

                    ids.forEach(id => {
                        const box = document.createElement("div");
                        box.classList.add("imagem-box");

                        const img = document.createElement("img");
                        img.src = `/imagens/imagem/${id}`;
                        img.classList.add("imagem-perfil");

                        box.appendChild(img);
                        container.appendChild(box);
                    });
                })
                .catch(err => {
                    console.error("Erro ao carregar imagens:", err);
                    alert("Erro ao carregar imagens.");
                });
        });

        //Inserir dados do usuario

        window.addEventListener("DOMContentLoaded", () => {
            // Carregar dados do usuário
            fetch("https://flash.up.railway.app/usuarios/perfil/dados", {
                method: "GET",
                credentials: "include"
            })
                .then(res => {
                    if (!res.ok) {
                        throw new Error("Usuário não autenticado");
                    }
                    return res.json();
                })
                .then(dados => {
                    document.getElementById("name-perfil").innerHTML = `<strong>Nome:</strong> <span class="small-text">${dados.nome}</span>`;
                    document.getElementById("email-perfil").innerHTML = `<strong>Email:</strong> <span class="small-text">${dados.email}</span>`;

                })
                .catch(err => {
                    console.error("Erro ao carregar perfil:", err);
                    alert("Erro ao carregar dados do perfil.");
                });
        });
    </script>
</head>

<body>
    <nav>
        <a id="voltar-btn" href="home.html">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                class="bi bi-arrow-left-circle-fill" viewBox="0 0 16 16">
                <path
                    d="M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0m3.5 7.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5z" />
            </svg>
        </a>
    </nav>
    <main id="main-container">
        <section id="perfil-container">
            <div id="perfil-photo-container">
                <img src="https://st3.depositphotos.com/4111759/13425/v/950/depositphotos_134255588-stock-illustration-empty-photo-of-male-profile.jpg"
                    id="perfil-photo" alt="">
            </div>
            <div id="perfil-description-container">
                <label id="name-perfil">Nome:</label>
                <label id="email-perfil">Email:</label>
                <label id="n-photos-perfil">Fotos editadas:</label>
            </div>
        </section>
        <section id="perfil-images-container">

        </section>
    </main>
</body>

</html>